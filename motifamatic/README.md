motifamatic
===========

This `motifamatic` program finds motifs by enumerating all possible
combinations of discretized position weight matrices.

## Discretized Position Weight Matrices ##

A Position Weight Matrix (PWM) specifies the probabilities of nucleotides at
each position of a motif of length n. For example, below is a PWM describing
splice donor sites in C. elegans. The site is 5 nt long (vertically) and
displays the probabilties of A, C, G, and T as rows in alphabetical order. The
most common sequence generated by this PWM is GTAAG.

```
% PWM donor.pwm 5
0.000000 0.000000 1.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.585843 0.014385 0.253544 0.146228
0.693677 0.056194 0.102556 0.147573
0.092932 0.035082 0.766325 0.105661
```

A discretized PWM allows only specific values for each probability. Here is a
discretized version where the only values allowed are 1.0, 0.25, or 0.0. We
might summarize this as GTNAG.

```
% PWM donor.pwm 5
0.000000 0.000000 1.000000 0.000000
0.000000 0.000000 0.000000 1.000000
0.250000 0.250000 0.250000 0.250000
1.000000 0.000000 0.000000 0.000000
0.000000 0.000000 1.000000 0.000000
```

Using IUPAC ambiguity codes, we can imagine encoding various distributions in
the degenerate nucleotide alphabet. Here, the values of 1.0, 0.5, 0.33, and 0.0
are used.

```
A 1.00 0.00 0.00 0.00
C 0.00 1.00 0.00 0.00
G 0.00 0.00 1.00 0.00
T 0.00 0.00 0.00 1.00
R 0.50 0.00 0.50 0.00
Y 0.00 0.50 0.00 0.50
M 0.50 0.50 0.00 0.00
K 0.00 0.00 0.50 0.50
W 0.50 0.00 0.00 0.50
S 0.00 0.50 0.50 0.00
B 0.00 0.33 0.33 0.33
D 0.33 0.00 0.33 0.33
H 0.33 0.33 0.00 0.33
V 0.33 0.33 0.33 0.00
N 0.25 0.25 0.25 0.25
```

When researchers display concensus sequences, they often use a mixture of
uppercase and lowercase letters. For example, let's examine the 3rd position of
the C. elegans splice donor site with probabilities 0.585843, 0.014385,
0.253544, and 0.146228. This could be represented as 'A' because adenine is
most common. But it's not a very strong 'A', so we might represent it as
lowercase 'a'. Alternatively, we might appreciate that it has a high
probability of guanine also. We could assign this as 'R' or 'r'. Finally, we
could call it 'N' because all of the letters have appreciable probabilities.

To extend the space of discretized PWMs, we can add lowercase letters and give
them less extreme values as the uppercase.

`motifamatic` gives users the ability to choose how many discretized values are
present and their individual values. Defaults are provided.

## Reduction Filters ##

Enumerating all possible combinations of discretized motifs may result in a
vast number of PWMs. For example, when using the full alphabet of uppercase and
lowercase letters, there are 500,246,412,961 motifs of length 8 (29^8). Many of
these motifs, for example NNNNNNNN, are incapable of producing a motif with
enough information content to be discriminative. Additionally, there are other
motifs, such as AAAAAAAA, that have very low complexity, and may appear
frequently because genomes have a lot of low entropy sequences. For these
reasons, there are minimum score and minimum entropy filters to reduce the
number of motifs that are analyzed.

## Probability Models ##

Motif-finding programs have historically used a variety of probability models
to assess the statistical significance for the presence of a motif within a
collection of sequences.

...

## To Do ##

+ minimum complexity filter
+ minimum score filter
- sequence black-listing?
- reverse-complement motifs/search
- motif comparison
- research the various MEME model probabilities (and others)
- determine proper threshold for scoring
- figure out how to do multi-motif multi-sequence p-values
